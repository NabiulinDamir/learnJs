import{a as h}from"./chunk-J7HVS52F.js";import{$a as m,Aa as u,Ob as c,Qa as f,Ra as g,Ub as D,Vb as O,Wb as x,_a as d,ab as v,cb as y,kb as p,lb as C,qa as l,ra as s,rb as w,wa as r,zb as _}from"./chunk-4OZAX3O6.js";function E(a,t){a&1&&(d(0,"div",3),C(1," \u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445 "),m())}var T=class a{constructor(t,e,i,n){this.localStorage=t;this.datePipe=e;this.filter=i;this.theme=n;_(()=>{this.setOption()})}_incomeChart=void 0;_expensChart=void 0;setOption(){let t=this.localStorage.filter(this.localStorage.getOperationsByType("income")),e=this.localStorage.filter(this.localStorage.getOperationsByType("expens"));this._incomeChart?.setOption(this.getOption(t,"\u0414\u043E\u0445\u043E\u0434\u044B")),this._expensChart?.setOption(this.getOption(e,"\u0420\u0430\u0441\u0445\u043E\u0434\u044B"))}init(){let t=document.getElementById("my-chart-rounded-income"),e=document.getElementById("my-chart-rounded-expens");t?.removeAttribute("_echarts_instance_"),e?.removeAttribute("_echarts_instance_"),this._incomeChart=h(t,this.theme.darkTheme()?"dark":""),this._expensChart=h(e,this.theme.darkTheme()?"dark":""),this.setOption()}getOption(t,e){let i=this.format(t);return{backgroundColor:"transparent",tooltip:{trigger:"item"},title:{text:`${e}: ${t.reduce((n,o)=>n+=o.value,0)} \u0440\u0443\u0431.`,position:"top"},series:[{name:"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F",type:"pie",radius:["40%","70%"],data:i,top:"10%",label:{show:!0,position:"outside"},color:["#0d6efd","#0a58ca","#3d8bfd","#6ea8fe","#9fcdff","#084298","#052c65"]}]}}format(t){let e=new Map;return t.forEach(n=>{let o=n.category;e.has(o)||e.set(o,{name:o,value:0});let b=e.get(o).value;e.set(o,{name:o,value:b+n.value})}),Array.from(e.values())}formatDate(t){let e=()=>{switch(this.filter.interval()){case"day":return"H";case"month":return"d";case"year":return"MMMM";default:return"dd.MM.yyyy"}};return this.datePipe.transform(t,e())}ngAfterViewInit(){this.init()}ngOnDestroy(){this._incomeChart?.dispose(),this._expensChart?.dispose()}onWindowResize(){this._incomeChart&&this._incomeChart.resize(),this._expensChart&&this._expensChart.resize()}get hasData(){return this.localStorage.filter(this.localStorage.allOperations()).length>0}static \u0275fac=function(e){return new(e||a)(r(x),r(c),r(O),r(D))};static \u0275cmp=u({type:a,selectors:[["my-chart-two-rounded"]],hostBindings:function(e,i){e&1&&y("resize",function(){return i.onWindowResize()},l)},features:[w([c])],decls:4,vars:5,consts:[[1,"position-relative","h-100","w-100","d-flex","justify-content-around"],["id","my-chart-rounded-income",2,"width","30rem","max-width","40vw"],["id","my-chart-rounded-expens",2,"width","30rem","max-width","40vw"],[1,"position-absolute","top-0","left-0","w-100","h-100","z-3","d-flex","justify-content-center","align-items-center"]],template:function(e,i){e&1&&(d(0,"div",0),v(1,"div",1)(2,"div",2),f(3,E,2,0,"div",3),m()),e&2&&(s(),p("opacity-50",!i.hasData),s(),p("opacity-50",!i.hasData),s(),g(i.hasData?-1:3))},encapsulation:2})};export{T as ChartTwoRounded};
